# SimpleCalculator

### Простой (или не очень) CLI калькулятор на Python с поддержкой переменных и пользовательских функций.

Лабораторная работа №1 (вариант М4).

## Особенности
- **Использует только стандартную библиотеку. Не использует регулярные выражения.**
- **Вычисление выражений с множеством операций.**
- **Поддержка вещественных чисел (в т. ч. отрицательных).**
- **Формат вещественных чисел из Python: допускаются '_' в записи.**
- **Обработка комбинаций скобок практически любой сложности.**
- **Задание переменных: `x = 12 + 5`.**
- **Встроенные функции: `min(), max(), sqrt(), abs(), pow()`.**
- **Неограниченное кол-во аргументов в `min`, и `max`.**
- **Задание пользовательских `lambda` функций: `func = lambda(x, y): x + y`.**

## Допущения
- Все вычисления проводятся с вещественными числами и округляются до 2-х знаков после запятой.
- Идентификатор не может начинаться с цифры, может содержать только латинские буквы, цифры и '_'.
- В операциях '%' и '//' оба операнда должны быть целыми числами (из задания).
- 0**0 = 1 (аналогично Python).
- Рекуррентное задание переменных работает корректно.
- Технически рекурсия в функциях работает, но из-за отсутствия ветвления её невозможно остановить, поэтому она всегда будет завершаться ошибкой переполнения стека.

## Тесты
Имеются как юнит-тесты отдельных функций, так и 'сквозные' тесты.
Тестами покрыт практически весь основной функционал, проверены как различные успешные случаи, так и некорректные вводы.
Интересные (возможно) тесты:
- Очень длинное выражение (140 различных операций и очень много скобок)
- Всевозможные комбинации скобок
- Лишние скобки - (((1+2)))
- Композиция функций
- Порядок выполнения правоассоциативных операторов

## Результаты
- Код получился относительно чистым: удалось избежать рекурсивных зависимостей (выражения вызывают функции, а функции могут задаваться выражением);
  более-менее соблюдено разделение ответственности; не нарушен LSP (хотя CodeBasedFunction и UserDefinedFunction требуют разных данных).
- Обошелся без регулярных выражений.
- Практически все функции полностью задокументированы.
- Хорошее покрытие тестами разных видов (70+ кейсов). В pre-commit добавлено авто-выполнение тестов перед коммитом (19 ms, приемлемо для такого проекта).
- Сработался со статическими анализаторами из pre-commit.
- Попробовал `uv`. Раньше использовал в основном `poetry`.
- Заставил себя написать нормальный README.

## Установка
Клонирование репозитория:
```shell
git clone https://github.com/TheMrKan/SimpleCalculator
cd SimpleCalculator
```
Запуск:
```shell
python3 -m src.main
```
### Зависимости
Тестировался на **Python 3.12**, и **3.10**.
Для использования установка каких-либо пакетов не требуется.

Для разработки потребуется установить `uv`:
```shell
python3 -m pip install uv
```
Установить пакеты (`pre-commit`):
```shell
uv sync
```
Включить pre-commit:
```shell
pre-commit install
```
